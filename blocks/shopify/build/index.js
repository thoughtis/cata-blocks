(()=>{"use strict";var e,t={321:(e,t,a)=>{const o=window.wp.blocks,r=window.wp.blockEditor,i=window.wp.element,s=window.wp.components,c=window.wp.data,l=window.wp.apiFetch;var n=a.n(l);const p=window.wp.compose,u=window.ReactJSXRuntime;function d({value:e,onDebouncedChange:t,timeout:a,...o}){const[r,c]=(0,i.useState)(e),[l,n]=(0,i.useState)(e),d=(0,p.useDebounce)(n,a);return(0,i.useEffect)((()=>{l!==r&&d(r)}),[l,r]),(0,i.useEffect)((()=>{t(l)}),[l]),(0,u.jsx)(s.TextControl,{value:r,onChange:c,...o})}function h({image:e}){return(0,u.jsx)("figure",{className:"wp-block-cata-shopify-product__image",children:(0,u.jsx)("img",{loading:"lazy",src:e.url,alt:e.altText,sizes:"(max-width: 576px) 92.5vw, 576px",srcSet:e.url+"?resize=384,384 384w, "+e.url+"?resize=768,768 768w, "+e.url+"?resize=1152,1152 1152w",width:"384",height:"384"})})}function f({price:e}){const t=parseFloat(e.maxVariantPrice.amount).toFixed(2),a=parseFloat(e.minVariantPrice.amount).toFixed(2);return e=t!==a?"$"+a+" - $"+t:"$"+a,(0,u.jsx)("div",{className:"wp-block-cata-shopify-product__price",children:(0,u.jsx)("span",{children:e})})}function x({product:e,display_price:t}){return(0,u.jsx)("article",{className:"wp-block-cata-shopify-product",children:(0,u.jsxs)("div",{className:"wp-block-cata-shopify-product__layout",children:[(0,u.jsx)("div",{className:"wp-block-cata-shopify-product__start",children:e.featuredImage&&(0,u.jsx)(h,{image:e.featuredImage})}),(0,u.jsxs)("div",{className:"wp-block-cata-shopify-product__end",children:[(0,u.jsx)("h3",{className:"wp-block-cata-shopify-product__title",children:(0,u.jsx)("a",{className:"wp-block-cata-shopify-product__link",href:e.onlineStoreUrl,children:e.title})}),t&&(0,u.jsx)(f,{price:e.priceRange})]})]})})}function m({products:e,display_price:t}){return 0===e.length?(0,u.jsx)("p",{children:"No products, update the options to try again."}):(0,u.jsx)("div",{className:"wp-block-cata-shopify__layout",children:e.map(((e,a)=>(0,u.jsx)(x,{product:e,display_price:t},`cata-blocks-shopify-product-${a}`)))})}(0,o.registerBlockType)("cata/shopify",{edit:function({attributes:e,setAttributes:t}){const{store:a,count:o,tags:l}=e,p=(0,c.useSelect)((e=>e("cata/blocks").getShopifyData()),[]),[h,f]=(0,i.useState)([]);function x(e){f([]),console.error(e)}return(0,i.useEffect)((function(){""!==a?n()({path:"/cata/v1/shopify-proxy",method:"POST",data:{...e}}).then((e=>{f(e.flat())})).catch(x):f([])}),[a,o,l]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{...(0,r.useBlockProps)(),children:(0,u.jsx)(m,{products:h,display_price:e.display_price})}),(0,u.jsxs)(r.InspectorControls,{children:[(0,u.jsx)(s.PanelBody,{title:"Store",initialOpen:!1,children:(0,u.jsx)(s.PanelRow,{children:(0,u.jsx)(s.SelectControl,{label:"Store",value:a,onChange:e=>{t({store:e})},options:[{value:"",label:"Select a store..."},...p.map((e=>({value:e,label:e})))]})})}),(0,u.jsxs)(s.PanelBody,{title:"Product Selection",initialOpen:!1,children:[(0,u.jsx)(d,{label:"Product Tag Names",onDebouncedChange:e=>t({tags:e}),timeout:300,type:"text",value:l,help:"Enter multiple tag names in a comma separated list."}),(0,u.jsx)(s.TextControl,{label:"Number of Products",onChange:e=>t({count:e}),type:"number",value:o})]}),(0,u.jsx)(s.PanelBody,{title:"Product Block Options",initialOpen:!1,children:(0,u.jsx)(s.ToggleControl,{label:"Display product price",help:e.display_price?"Product price shown.":"No product price.",checked:e.display_price,onChange:e=>{t({display_price:e})}})})]})]})},save:function(){return(0,u.jsx)("div",{...r.useBlockProps.save()})}}),(0,o.registerBlockStyle)("cata/shopify",{name:"reel",label:"Reel"}),(0,o.registerBlockStyle)("cata/shopify",{name:"list",label:"List"})}},a={};function o(e){var r=a[e];if(void 0!==r)return r.exports;var i=a[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.m=t,e=[],o.O=(t,a,r,i)=>{if(!a){var s=1/0;for(p=0;p<e.length;p++){for(var[a,r,i]=e[p],c=!0,l=0;l<a.length;l++)(!1&i||s>=i)&&Object.keys(o.O).every((e=>o.O[e](a[l])))?a.splice(l--,1):(c=!1,i<s&&(s=i));if(c){e.splice(p--,1);var n=r();void 0!==n&&(t=n)}}return t}i=i||0;for(var p=e.length;p>0&&e[p-1][2]>i;p--)e[p]=e[p-1];e[p]=[a,r,i]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};o.O.j=t=>0===e[t];var t=(t,a)=>{var r,i,[s,c,l]=a,n=0;if(s.some((t=>0!==e[t]))){for(r in c)o.o(c,r)&&(o.m[r]=c[r]);if(l)var p=l(o)}for(t&&t(a);n<s.length;n++)i=s[n],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(p)},a=globalThis.webpackChunk=globalThis.webpackChunk||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var r=o.O(void 0,[350],(()=>o(321)));r=o.O(r)})();