!function(){var e,t={285:function(){},739:function(e,t,r){"use strict";var n={};r.r(n);var a=window.wp.blocks,l=window.wp.element,o=window.wp.i18n,c=window.wp.blockEditor,i=window.wp.components,u=window.wp.apiFetch,s=r.n(u),p=window.wp.primitives,d=(0,l.createElement)(p.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,l.createElement)(p.Path,{fillRule:"evenodd",d:"M19.75 11H21V8.667L19.875 4H4.125L3 8.667V11h1.25v8.75h15.5V11zm-1.5 0H5.75v7.25H10V13h4v5.25h4.25V11zm-5.5-5.5h2.067l.486 3.24.028.76H12.75v-4zm-3.567 0h2.067v4H8.669l.028-.76.486-3.24zm7.615 3.1l-.464-3.1h2.36l.806 3.345V9.5h-2.668l-.034-.9zM7.666 5.5h-2.36L4.5 8.845V9.5h2.668l.034-.9.464-3.1z",clipRule:"evenodd"})),m=window.wp.data;function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h.apply(this,arguments)}var g=window.wp.compose;function f(e){let{value:t,onDebouncedChange:r,timeout:n,...a}=e;const[o,c]=(0,l.useState)(t),[u,s]=(0,l.useState)(t),p=(0,g.useDebounce)(s,n);return(0,l.useEffect)((()=>{u!==o&&p(o)}),[u,o]),(0,l.useEffect)((()=>{r(u)}),[u]),(0,l.createElement)(i.TextControl,h({value:o,onChange:c},a))}function y(e){let{authors:t,brands:r}=e;return(0,l.createElement)("div",{className:"wp-block-cata-product__byline"},t.length>0&&(0,o.__)("by ","cata")+t.map((e=>e.display_name)).join(", "),!t.length>0&&r.length>0&&(0,o.__)("from ","cata")+r.map((e=>e.name)).join(", "))}function b(e){let{onSale:t,price:r,regularPrice:n,salePrice:a}=e;const o=t&&n&&a,c=r&&n&&!t&&r!==n;return(0,l.createElement)("div",{className:"wp-block-cata-product__price"},o&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("del",null,(0,l.createElement)("span",null,(0,l.createElement)("span",null,"$"),n))," ",(0,l.createElement)("ins",null,(0,l.createElement)("span",null,(0,l.createElement)("span",null,"$"),a))),c&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("span",null,(0,l.createElement)("span",null,"$"),r)," - ",(0,l.createElement)("span",null,(0,l.createElement)("span",null,"$"),n)),n&&!o&&!c&&(0,l.createElement)("span",null,(0,l.createElement)("span",null,"$"),n))}function w(e){let{product:t,display:r}=e;const{byline:n,price:a}=r;return(0,l.createElement)("article",{className:"wp-block-cata-product"},(0,l.createElement)("div",{className:"wp-block-cata-product__layout"},(0,l.createElement)("figure",{className:"wp-block-cata-product__image"},(0,l.createElement)("img",{loading:"lazy",src:t.images[0].src,alt:t.images[0].alt,sizes:"(max-width: 576px) 92.5vw, 576px",srcSet:t.images[0].src+"?resize=384,384 384w, "+t.images[0].src+"?resize=768,768 768w, "+t.images[0].src+"?resize=1152,1152 1152w",width:"384",height:"384"})),(0,l.createElement)("h3",{className:"wp-block-cata-product__title"},(0,l.createElement)("a",{className:"wp-block-cata-product__link",href:t.permalink},t.name)),n&&(0,l.createElement)(y,{authors:t.cap_guest_authors,brands:t.brands}),a&&(0,l.createElement)(b,{onSale:t.on_sale,price:t.price,regularPrice:t.regular_price,salePrice:t.sale_price})))}function E(e){let{products:t,display_byline:r,display_price:n}=e;return 0===t.length?(0,l.createElement)("p",null,"No products, update the options to try again."):(0,l.createElement)("div",{className:"wp-block-cata-products__layout"},t.map((e=>(0,l.createElement)(w,{key:`cata-product-${e.id}`,product:e,display:{byline:r,price:n}}))))}var _=r(285);s().use(_.proxyMiddleware),s().use(_.cacheMiddleware),(0,a.registerBlockType)("cata/products",{edit:function(e){let{attributes:t,setAttributes:r}=e;const{shopCatalogApiUrlBase:a,category:o,product_cat_exclude:u,coauthor:p,tag:h,per_page:g,orderby:y,order:b,query_url:w}=t,[_,v]=(0,l.useState)([]),k=(0,m.useDispatch)("core/notices");function C(e){"AbortError"!==e.name&&k.createErrorNotice(e.message,{isDismissible:!0})}return(0,l.useEffect)((function(){const e=Object.fromEntries(Object.entries({category:o,product_cat_exclude:u,coauthor:p,tag:h}).filter((e=>{let[t,r]=e;return 0<r.length})));r({query_url:a+"?"+new URLSearchParams({...e,per_page:g,orderby:y,order:b,status:"publish"}).toString()})}),[o,u,p,h,g]),(0,l.useEffect)((function(){if(""===w)return;const e=new AbortController;return s()({path:w,cata:{useProxy:!0,useCache:!0},signal:e.signal}).then(v).catch(C),()=>{e.abort()}}),[w]),(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",(0,c.useBlockProps)(),(0,l.createElement)(E,{products:_,display_byline:t.display_byline,display_price:t.display_price})),(0,l.createElement)(c.InspectorControls,null,(0,l.createElement)(i.PanelBody,{title:"Product Selection",icon:d,initialOpen:!1},(0,l.createElement)(i.TextControl,{label:"Include Product Category Id",onChange:e=>r({category:e}),type:"text",value:o,help:"A product category id can be found in the URL of the Shop Catalog category edit page. Like this -> (...&tag_ID=XXXX...)."}),(0,l.createElement)(i.TextControl,{label:"Exclude Product Category Id",onChange:e=>r({product_cat_exclude:e}),type:"text",value:u,help:"A product category id can be found in the URL of the Shop Catalog category edit page. Like this -> (...&tag_ID=XXXX...)."}),(0,l.createElement)(i.TextControl,{label:"Product Tag Id",onChange:e=>r({tag:e}),type:"text",value:h,help:"A product tag id can be found in the URL of the Shop Catalog tag edit page. Like this -> (...&tag_ID=XXXX...)."}),(0,l.createElement)(f,{label:"Product Author Slug",onDebouncedChange:e=>r({coauthor:e}),timeout:300,type:"text",value:p,placeholder:"author-name",help:"Find an author's slug in the URL of their profile. Ex: https://shopcatalog.com/people/author-name/"}),(0,l.createElement)(i.TextControl,{label:"Number of Products",onChange:e=>r({per_page:e}),type:"number",value:g})),(0,l.createElement)(i.PanelBody,{title:"Product Block Options",icon:n.generic,initialOpen:!1},(0,l.createElement)(i.ToggleControl,{label:"Display product byline",help:t.display_byline?"Product byline shown.":"No product byline.",checked:t.display_byline,onChange:e=>{r({display_byline:e})}}),(0,l.createElement)(i.ToggleControl,{label:"Display product price",help:t.display_price?"Product price shown.":"No product price.",checked:t.display_price,onChange:e=>{r({display_price:e})}}))))},save:function(){return(0,l.createElement)("div",c.useBlockProps.save())}}),(0,a.registerBlockStyle)("cata/products",{name:"reel",label:"Reel"})}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var l=r[e]={exports:{}};return t[e](l,l.exports,n),l.exports}n.m=t,e=[],n.O=function(t,r,a,l){if(!r){var o=1/0;for(s=0;s<e.length;s++){r=e[s][0],a=e[s][1],l=e[s][2];for(var c=!0,i=0;i<r.length;i++)(!1&l||o>=l)&&Object.keys(n.O).every((function(e){return n.O[e](r[i])}))?r.splice(i--,1):(c=!1,l<o&&(o=l));if(c){e.splice(s--,1);var u=a();void 0!==u&&(t=u)}}return t}l=l||0;for(var s=e.length;s>0&&e[s-1][2]>l;s--)e[s]=e[s-1];e[s]=[r,a,l]},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e={826:0,431:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,l,o=r[0],c=r[1],i=r[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(a in c)n.o(c,a)&&(n.m[a]=c[a]);if(i)var s=i(n)}for(t&&t(r);u<o.length;u++)l=o[u],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(s)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var a=n.O(void 0,[431],(function(){return n(739)}));a=n.O(a)}();