(()=>{"use strict";const e=window.wp.compose,t=window.wp.hooks,o=window.wp.i18n,r=window.wp.components,l=window.wp.blockEditor,n=window.ReactJSXRuntime;const c=(0,e.createHigherOrderComponent)((e=>t=>{const{attributes:c,setAttributes:s,isSelected:i}=t;return a(c)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e,{...t}),i&&(0,n.jsx)(l.InspectorControls,{group:"dimensions",children:(0,n.jsx)(r.__experimentalNumberControl,{label:(0,o.__)("Flex Grow","cata"),value:c.cataBlocksFlexGrow,min:0,onChange:e=>{s({cataBlocksFlexGrow:e})}})})]}):(0,n.jsx)(e,{...t})}),"withFlexGrowControl"),s=(0,e.createHigherOrderComponent)((e=>t=>{const{attributes:o}=t;return a(o)||(o.cataBlocksFlexGrow=null),null===o.cataBlocksFlexGrow||void 0===o.cataBlocksFlexGrow?(delete o.cataBlocksFlexGrow,(0,n.jsx)(e,{...t})):(0,n.jsx)(e,{...t,wrapperProps:{style:{flexGrow:o.cataBlocksFlexGrow}}})}),"withFlexGrowStyle");function a(e){const t=e.style;if(void 0!==t&&void 0!==t.layout&&"fixed"===t.layout.selfStretch)return!0}const i=window.wp.element;function u(){const[e,t]=(0,i.useState)({canvas:null});if(null===e.canvas){const e=document.querySelector("#site-editor"),l=document.querySelector("#editor");if(e){var o;const e=null!==(o=document.querySelector(".edit-site-visual-editor__editor-canvas")?.contentDocument?.querySelector(".editor-styles-wrapper"))&&void 0!==o?o:null;e&&t({canvas:e})}if(l){const e=l.querySelector("iframe[name=editor-canvas]");if(e){var r;const o=null!==(r=e?.contentDocument?.querySelector(".editor-styles-wrapper"))&&void 0!==r?r:null;o&&t({canvas:o})}else{const e=document.querySelector(".editor-styles-wrapper");e&&t({canvas:e})}}}return{canvas:e.canvas,getBlockByClientId:function(t){return null===e.canvas?null:e.canvas.querySelector(`#block-${t}`)}}}const d=(0,e.createHigherOrderComponent)((e=>t=>{const{attributes:o}=t;return null===o.cataBlocksColorScheme||void 0===o.cataBlocksColorScheme||""===o.cataBlocksColorScheme?(delete o.cataBlocksColorScheme,(0,n.jsx)(e,{...t})):(0,n.jsx)(e,{...t,wrapperProps:{style:{colorScheme:o.cataBlocksColorScheme}}})}),"withColorSchemeStyle");const w=window.wp.primitives,p=(0,n.jsx)(w.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,n.jsx)(w.Path,{d:"M10 17.389H8.444A5.194 5.194 0 1 1 8.444 7H10v1.5H8.444a3.694 3.694 0 0 0 0 7.389H10v1.5ZM14 7h1.556a5.194 5.194 0 0 1 0 10.39H14v-1.5h1.556a3.694 3.694 0 0 0 0-7.39H14V7Zm-4.5 6h5v-1.5h-5V13Z"})}),k=window.wp.url;const g=(0,e.createHigherOrderComponent)((e=>t=>{const{attributes:c,setAttributes:s,isSelected:a,name:u}=t;if("safe-svg/svg-icon"!==u)return(0,n.jsx)(e,{...t});const{url:d,linkTarget:w}=c,[g,v]=(0,i.useState)(!1),m="_blank"===w;(0,i.useEffect)((()=>{a||v(!1)}),[a]);const h=(0,i.useMemo)((()=>({url:d,opensInNewTab:m})),[d,m]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e,{...t}),a&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(l.BlockControls,{children:[(0,n.jsx)(r.ToolbarButton,{name:"link",icon:p,title:(0,o.__)("Link"),onClick:function(e){e.preventDefault(),v(!0)}}),g&&(0,n.jsx)(r.Popover,{placement:"bottom-start",onClose:()=>{v(!1)},children:(0,n.jsx)(r.MenuGroup,{children:(0,n.jsx)(l.LinkControl,{value:h,onChange:({url:e,opensInNewTab:t})=>s(function({url:e="",opensInNewTab:t}){let o;return t&&(o="_blank"),{url:(0,k.prependHTTP)(e),linkTarget:o}}({url:e,opensInNewTab:t})),onRemove:()=>{s({url:void 0,linkTarget:void 0}),v(!1)}})})})]})})]})}),"withSvgUrlControl"),v=window.wp.editor,m=window.wp.plugins,h=window.React;(0,m.registerPlugin)("cata-blocks-color-scheme-preview",{render:()=>{const[e,t]=(0,i.useState)(!1),{canvas:o}=u();return(0,h.useEffect)((()=>{o&&(o.style.colorScheme=e?"dark only":"")}),[o,e]),(0,n.jsx)(v.PluginPreviewMenuItem,{onClick:()=>{t(!e)},children:e?"Preview Light Mode":"Preview Dark Mode"})}}),(0,t.addFilter)("blocks.registerBlockType","cata/add-color-scheme-attribute",(function(e,t){return void 0===e.attributes||Object.assign(e.attributes,{cataBlocksColorScheme:{type:"string"}}),e})),(0,t.addFilter)("editor.BlockEdit","cata/color-scheme-control",(e=>t=>{const{attributes:c,setAttributes:s,isSelected:a}=t,{getBlockByClientId:d}=u();return(0,i.useEffect)((()=>{if(!a)return;const e=d(t.clientId);e&&window.document.body.classList.toggle("has-active-dark-mode-element","dark only"===getComputedStyle(e).colorScheme)}),[a,c.cataBlocksColorScheme]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e,{...t}),a&&(0,n.jsx)(l.InspectorControls,{group:"color",children:(0,n.jsx)(r.SelectControl,{value:c.cataBlocksColorScheme,options:[{label:"Original",value:""},{label:"Light",value:"light only"},{label:"Dark",value:"dark only"}],label:(0,o.__)("Color Scheme","cata"),onChange:e=>{s({cataBlocksColorScheme:e})}})})]})})),(0,t.addFilter)("editor.BlockListBlock","cata/color-scheme-editor-style",d),(0,t.addFilter)("blocks.getSaveContent.extraProps","cata/apply-color-scheme-attribute",(function(e,t,o){const{cataBlocksColorScheme:r}=o;return null==r||""===r||Object.assign(e,{style:{...e.style,colorScheme:r}}),e})),(0,t.addFilter)("blocks.registerBlockType","cata/add-flex-grow-attribute",(function(e,t){return void 0===e.attributes||Object.assign(e.attributes,{cataBlocksFlexGrow:{type:"int"}}),e})),(0,t.addFilter)("editor.BlockEdit","cata/flex-grow-control",c),(0,t.addFilter)("editor.BlockListBlock","cata/flex-grow-editor-style",s),(0,t.addFilter)("blocks.getSaveContent.extraProps","cata/apply-flex-grow-attribute",(function(e,t,o){const{cataBlocksFlexGrow:r}=o;return a(o)&&null!=r?(Object.assign(e,{style:{...e.style,flexGrow:r}}),e):e})),(0,t.addFilter)("blocks.registerBlockType","cata/add-svg-link-color-support",(function(e,t){return"safe-svg/svg-icon"!==t||void 0===e.attributes||Object.assign(e.supports.color,{...e.supports.color,link:!0}),e})),(0,t.addFilter)("blocks.registerBlockType","cata/add-svg-url-attribute",(function(e,t){return"safe-svg/svg-icon"!==t||void 0===e.attributes||Object.assign(e.attributes,{url:{type:"string"},linkTarget:{type:"string"}}),e})),(0,t.addFilter)("editor.BlockEdit","cata/svg-url-control",g)})();