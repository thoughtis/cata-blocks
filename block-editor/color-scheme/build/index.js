(()=>{"use strict";const e=window.wp.compose,o=window.wp.hooks,t=window.wp.i18n,c=window.wp.components,l=window.wp.blockEditor,r=window.wp.element;function n(){const e=document.querySelector("#site-editor"),o=document.querySelector("#editor");let t=null;if(e){var c;const e=null!==(c=document.querySelector(".edit-site-visual-editor__editor-canvas")?.contentDocument?.querySelector(".editor-styles-wrapper"))&&void 0!==c?c:null;e&&(t=e)}if(o){const e=o.querySelector("iframe[name=editor-canvas]");if(e){var l;const o=null!==(l=e?.contentDocument?.querySelector(".editor-styles-wrapper"))&&void 0!==l?l:null;o&&(t=o)}else{const e=document.querySelector(".editor-styles-wrapper");e&&(t=e)}}return t}const s=window.wp.blocks,a=window.ReactJSXRuntime;const i=(0,e.createHigherOrderComponent)((e=>o=>{const{attributes:t}=o;return null===t.cataBlocksColorScheme||void 0===t.cataBlocksColorScheme||""===t.cataBlocksColorScheme?(delete t.cataBlocksColorScheme,(0,a.jsx)(e,{...o})):(0,a.jsx)(e,{...o,wrapperProps:{style:{colorScheme:t.cataBlocksColorScheme}}})}),"withColorSchemeStyle");const d=window.wp.editor,u=window.wp.plugins,m=window.React;(0,o.addFilter)("blocks.registerBlockType","cata/add-color-scheme-attribute",(function(e,o){return void 0===e.attributes||!0!==(0,s.hasBlockSupport)(e,"color",!1)||Object.assign(e.attributes,{cataBlocksColorScheme:{type:"string"}}),e})),(0,o.addFilter)("editor.BlockEdit","cata/color-scheme-control",(e=>o=>{const{attributes:i,setAttributes:d,isSelected:u}=o,{getBlockByClientId:m}=function(){const[e,o]=(0,r.useState)({canvas:null});if(null===e.canvas){const e=n();null!==e&&o({canvas:e})}return{canvas:e.canvas,getBlockByClientId:function(o){return null===e.canvas?null:e.canvas.querySelector(`#block-${o}`)}}}(),w=(0,l.__experimentalUseMultipleOriginColorsAndGradients)();return(0,r.useEffect)((()=>{if(!u)return;const e=m(o.clientId);e&&window.document.body.classList.toggle("has-active-dark-mode-element","dark only"===getComputedStyle(e).colorScheme)}),[u,i.cataBlocksColorScheme]),!0!==(0,s.hasBlockSupport)(o.name,"color",!1)?(0,a.jsx)(e,{...o}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e,{...o}),u&&w.hasColorsOrGradients&&(0,a.jsx)(l.InspectorControls,{group:"color",children:(0,a.jsx)(c.SelectControl,{value:i.cataBlocksColorScheme,options:[{label:"Original",value:""},{label:"Light",value:"light only"},{label:"Dark",value:"dark only"}],label:(0,t.__)("Color Scheme","cata"),onChange:e=>{d({cataBlocksColorScheme:e})}})})]})})),(0,o.addFilter)("editor.BlockListBlock","cata/color-scheme-editor-style",i),(0,o.addFilter)("blocks.getSaveContent.extraProps","cata/apply-color-scheme-attribute",(function(e,o,t){const{cataBlocksColorScheme:c}=t;return null==c||""===c||Object.assign(e,{style:{...e.style,colorScheme:c}}),e})),(0,u.registerPlugin)("cata-blocks-color-scheme-preview",{render:()=>{const[e,o]=(0,r.useState)(!1);return(0,m.useEffect)((()=>{const o=n();o&&(o.style.colorScheme=e?"dark only":"")}),[e]),(0,a.jsx)(d.PluginPreviewMenuItem,{onClick:()=>{o(!e)},children:e?"Preview Light Mode":"Preview Dark Mode"})}})})();