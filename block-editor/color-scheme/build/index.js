(()=>{"use strict";const e=window.wp.components,t=window.wp.hooks,o=window.wp.i18n,c=window.wp.blockEditor,l=window.wp.element;function r(){const e=document.querySelector("#site-editor"),t=document.querySelector("#editor");let o=null;if(e){var c;const e=null!==(c=document.querySelector(".edit-site-visual-editor__editor-canvas")?.contentDocument?.querySelector(".editor-styles-wrapper"))&&void 0!==c?c:null;e&&(o=e)}if(t){const e=t.querySelector("iframe[name=editor-canvas]");if(e){var l;const t=null!==(l=e?.contentDocument?.querySelector(".editor-styles-wrapper"))&&void 0!==l?l:null;t&&(o=t)}else{const e=document.querySelector(".editor-styles-wrapper");e&&(o=e)}}return o}const n=window.wp.blocks,s=window.ReactJSXRuntime;const a=window.wp.editor,i=window.wp.plugins,u=window.React;(0,t.addFilter)("blocks.registerBlockType","cata/add-color-scheme-attribute",(function(e,t){return void 0===e.attributes||!0!==(0,n.hasBlockSupport)(e,"color",!1)||Object.assign(e.attributes,{cataBlocksColorScheme:{type:"string"}}),e})),(0,t.addFilter)("editor.BlockEdit","cata/color-scheme-control",(t=>a=>{const{attributes:i,setAttributes:u,isSelected:d}=a,{getBlockByClientId:m}=function(){const[e,t]=(0,l.useState)({canvas:null});if(null===e.canvas){const e=r();null!==e&&t({canvas:e})}return{canvas:e.canvas,getBlockByClientId:function(t){return null===e.canvas?null:e.canvas.querySelector(`#block-${t}`)}}}(),w=(0,c.__experimentalUseMultipleOriginColorsAndGradients)();return(0,l.useEffect)((()=>{if(!d)return;const e=m(a.clientId);e&&window.document.body.classList.toggle("has-active-dark-mode-element","dark only"===getComputedStyle(e).colorScheme)}),[d,i.cataBlocksColorScheme]),!0!==(0,n.hasBlockSupport)(a.name,"color",!1)?(0,s.jsx)(t,{...a}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t,{...a}),d&&w.hasColorsOrGradients&&(0,s.jsx)(c.InspectorControls,{group:"color",children:(0,s.jsx)(e.SelectControl,{value:i.cataBlocksColorScheme,style:{width:"100%"},options:[{label:"Default",value:""},{label:"Light",value:"light only"},{label:"Dark",value:"dark only"}],label:(0,o.__)("Color Scheme","cata"),onChange:e=>{u({cataBlocksColorScheme:e})}})})]})})),(0,t.addFilter)("editor.BlockListBlock","cata/color-scheme-editor-style",(function(e){return t=>{const{attributes:o}=t;return null===o.cataBlocksColorScheme||void 0===o.cataBlocksColorScheme||""===o.cataBlocksColorScheme?(delete o.cataBlocksColorScheme,(0,s.jsx)(e,{...t})):(0,s.jsx)(e,{...t,wrapperProps:{style:{colorScheme:o.cataBlocksColorScheme}}})}})),(0,t.addFilter)("blocks.getSaveContent.extraProps","cata/apply-color-scheme-attribute",(function(e,t,o){const{cataBlocksColorScheme:c}=o;return null==c||""===c||Object.assign(e,{style:{...e.style,colorScheme:c}}),e})),(0,i.registerPlugin)("cata-blocks-color-scheme-preview",{render:function(){const[e,t]=(0,l.useState)(!1);return(0,u.useEffect)((()=>{const t=r();t&&(t.style.colorScheme=e?"dark only":"")}),[e]),(0,s.jsx)(a.PluginPreviewMenuItem,{onClick:()=>{t(!e)},children:e?"Preview Light Mode":"Preview Dark Mode"})}})})();